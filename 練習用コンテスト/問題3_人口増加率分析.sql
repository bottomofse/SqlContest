SELECT
    T2015.PF_CODE 都道府県コード,
    P.PF_NAME 都道府県名,
    T2015.TOTAL_AMT 総人口2015年,
    T2020.TOTAL_AMT 総人口2020年,
    ROUND((CAST(T2020.TOTAL_AMT AS REAL) / CAST(T2015.TOTAL_AMT AS REAL)) * 100, 0) 人口増加率
FROM
    (
        SELECT *
        FROM POPU_TRANSITION
        WHERE SURVEY_YEAR = 2015
    ) T2015
LEFT OUTER JOIN
    (
        SELECT *
        FROM POPU_TRANSITION
        WHERE SURVEY_YEAR = 2020
    ) T2020
ON T2015.PF_CODE = T2020.PF_CODE
LEFT OUTER JOIN PREFECTURE P
ON T2015.PF_CODE = P.PF_CODE
WHERE T2015.TOTAL_AMT < T2020.TOTAL_AMT
ORDER BY 人口増加率 DESC, 都道府県コード ASC